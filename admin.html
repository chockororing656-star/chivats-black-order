<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>ADMIN ‚Äì CHIVATS BLACK</title>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import {
      getFirestore,
      collection,
      query,
      orderBy,
      onSnapshot
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // üî¥ ‡πÉ‡∏™‡πà config ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ index)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "XXXX",
      appId: "XXXX"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const orderList = document.getElementById("orders");

    const q = query(
      collection(db, "orders"),
      orderBy("time", "desc")
    );

    onSnapshot(q, (snapshot) => {
      orderList.innerHTML = "";
      snapshot.forEach(doc => {
        const d = doc.data();

        const date = d.time?.toDate();
        const dateText = date
          ? date.toLocaleDateString("th-TH") + " " + date.toLocaleTimeString("th-TH")
          : "-";

        let itemsHtml = "";
        d.items.forEach(i => {
          itemsHtml += `<li>${i.name} x ${i.qty} = ${i.price * i.qty}‡∏ø</li>`;
        });

        orderList.innerHTML += `
          <div class="card">
            <h3>üßæ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà</h3>
            <p><b>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤:</b> ${dateText}</p>
            <p><b>üë§ ‡∏ä‡∏∑‡πà‡∏≠:</b> ${d.name}</p>
            <p><b>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</b> ${d.phone}</p>
            <p><b>üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</b> ${d.payment}</p>
            <ul>${itemsHtml}</ul>
            <h4>üí∞ ‡∏£‡∏ß‡∏°: ${d.total} ‡∏ö‡∏≤‡∏ó</h4>
          </div>
        `;
      });
    });
  </script>

  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      padding: 20px;
    }
    h1 {
      color: #f5c16c;
    }
    .card {
      background: #1e1e1e;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 10px;
      border-left: 5px solid #f5c16c;
    }
    ul {
      margin-left: 20px;
    }
  </style>
</head>

<body>
  <h1>üì¶ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Äì CHIVATS BLACK</h1>
  <div id="orders">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
</body>
</html>
