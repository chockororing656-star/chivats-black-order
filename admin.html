<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>ADMIN â€“ CHIVATS BLACK ORDER</title>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import {
      getFirestore,
      collection,
      query,
      orderBy,
      onSnapshot
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
      authDomain: "chivats-black-order.firebaseapp.com",
      projectId: "chivats-black-order",
      storageBucket: "chivats-black-order.appspot.com",
      messagingSenderId: "1012545451252",
      appId: "1:1012545451252:web:0df1a74dc553f201bddaa1"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const ordersRef = collection(db, "orders");
    const q = query(ordersRef, orderBy("createdAt", "desc"));

    onSnapshot(q, (snapshot) => {
      const list = document.getElementById("orders");
      list.innerHTML = "";

      snapshot.forEach((doc) => {
        const data = doc.data();

        let itemsHTML = "";
        data.items.forEach(i => {
          itemsHTML += `<li>${i.name} x ${i.qty} (${i.price}à¸¿)</li>`;
        });

        list.innerHTML += `
          <div class="card">
            <h3>ðŸ‘¤ ${data.customerName}</h3>
            <p>ðŸ“ž ${data.phone}</p>
            <p>ðŸ’° ${data.total} à¸šà¸²à¸—</p>
            <p>ðŸ’³ ${data.payment}</p>
            <ul>${itemsHTML}</ul>
            <hr>
          </div>
        `;
      });

      // ðŸ”” à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¹ƒà¸«à¸¡à¹ˆ
      if (snapshot.docChanges().some(c => c.type === "added")) {
        new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg").play();
      }
    });
  </script>

  <style>
    body {
      background:#111;
      color:#fff;
      font-family:sans-serif;
      padding:20px;
    }
    .card {
      background:#1c1c1c;
      padding:15px;
      margin-bottom:15px;
      border-radius:8px;
    }
  </style>
</head>

<body>
  <h1>ðŸ“‹ à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸ªà¸” (Real-time)</h1>
  <div id="orders"></div>
</body>
</html>
