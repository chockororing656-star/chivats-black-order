<script>
function submitOrder(){

  const name = document.getElementById("customerName").value;
  const phone = document.getElementById("customerPhone").value;
  const payment = document.querySelector('input[name="pay"]:checked')?.value;

  if(!name || !phone || !payment){
    alert("กรอกข้อมูลให้ครบ");
    return;
  }

  const items = [];
  let total = 0;

  menuData.forEach((item,i)=>{
    if(cart[i] > 0){
      items.push({
        name: item.name,
        qty: cart[i],
        price: item.price
      });
      total += item.price * cart[i];
    }
  });

  if(items.length === 0){
    alert("ยังไม่ได้เลือกสินค้า");
    return;
  }

  firebase.firestore().collection("orders").add({
    name,
    phone,
    payment,
    items,
    total,
    status: "new",
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  })
  .then(()=>{
    alert("✅ ส่งออเดอร์เรียบร้อย");
    location.reload();
  })
  .catch(err=>{
    alert("❌ ส่งไม่สำเร็จ");
    console.error(err);
  });
}
</script>
