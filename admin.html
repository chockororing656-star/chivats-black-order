<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ADMIN ‚Äì CHIVATS BLACK</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#111;
  color:#fff;
}
.container{
  max-width:700px;
  margin:auto;
  padding:20px;
}
h1{
  color:#f5c16c;
}
.order{
  border:1px solid #333;
  padding:15px;
  margin-bottom:15px;
  border-radius:8px;
}
.accept{
  background:#3cff8f;
  border:none;
  padding:10px;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="container">
  <h1>üì¶ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
  <div id="orders">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
</div>

<script>
/* ===== Firebase config (‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ===== */
const firebaseConfig = {
  apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
  authDomain: "chivats-black-order.firebaseapp.com",
  projectId: "chivats-black-order",
  storageBucket: "chivats-black-order.appspot.com",
  messagingSenderId: "1012545451252",
  appId: "1:1012545451252:web:0df1a74dc553f201bddaa1"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const ordersDiv = document.getElementById("orders");

/* ===== ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ===== */
db.collection("orders")
  .onSnapshot(snapshot=>{
    ordersDiv.innerHTML = "";

    if(snapshot.empty){
      ordersDiv.innerHTML = "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå";
      return;
    }

    snapshot.forEach(doc=>{
      const o = doc.data();

      let itemsHTML = "";
      o.items.forEach(i=>{
        itemsHTML += `- ${i.name} x ${i.qty}<br>`;
      });

      ordersDiv.innerHTML += `
        <div class="order">
          <b>‡∏ä‡∏∑‡πà‡∏≠:</b> ${o.name}<br>
          <b>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</b> ${o.phone}<br><br>
          <b>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</b><br>${itemsHTML}<br>
          <b>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</b> ${o.total} ‡∏ö‡∏≤‡∏ó<br>
          <b>‡∏ä‡∏≥‡∏£‡∏∞:</b> ${o.payment}<br><br>
          <button class="accept" onclick="acceptOrder('${doc.id}')">
            ‚úÖ ‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
          </button>
        </div>
      `;
    });
  });

/* ===== ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ===== */
function acceptOrder(id){
  db.collection("orders").doc(id).update({
    status: "accepted"
  });
  alert("‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß");
}
</script>
</body>
</html>
