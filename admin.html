<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ADMIN ‚Äì CHIVATS BLACK</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#111;
  color:#fff;
}
.container{
  max-width:800px;
  margin:auto;
  padding:20px;
}
.order{
  border:1px solid #444;
  padding:15px;
  margin-bottom:15px;
  border-radius:8px;
}
.accept{
  background:#3cff8f;
  border:none;
  padding:10px;
  cursor:pointer;
  width:100%;
  font-size:16px;
}
</style>
</head>

<body>
<div class="container">
  <h1>üìã ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
  <div id="orders">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
</div>

<script>
/* üî• Firebase Config (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ index.html) */
firebase.initializeApp({
  apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
  authDomain: "chivats-black-order.firebaseapp.com",
  projectId: "chivats-black-order",
});

const db = firebase.firestore();
const ordersDiv = document.getElementById("orders");

/* üîÅ ‡∏î‡∏∂‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå */
db.collection("orders")
  .orderBy("time","desc")
  .onSnapshot(snapshot=>{
    ordersDiv.innerHTML = "";
    if(snapshot.empty){
      ordersDiv.innerHTML = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå";
      return;
    }

    snapshot.forEach(doc=>{
      const o = doc.data();
      let items = "";
      o.items.forEach(i=>{
        items += `- ${i.name} x ${i.qty}<br>`;
      });

      ordersDiv.innerHTML += `
        <div class="order">
          <b>‡∏ä‡∏∑‡πà‡∏≠:</b> ${o.name}<br>
          <b>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</b> ${o.phone}<br>
          <b>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</b><br>${items}
          <b>‡∏¢‡∏≠‡∏î:</b> ${o.total} ‡∏ö‡∏≤‡∏ó<br>
          <b>‡∏ä‡∏≥‡∏£‡∏∞:</b> ${o.payment}<br><br>
          <button class="accept" onclick="acceptOrder('${doc.id}')">
            ‚úÖ ‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
          </button>
        </div>
      `;
    });
  });

function acceptOrder(id){
  db.collection("orders").doc(id).update({
    status:"accepted"
  });
  alert("‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß");
}
</script>
</body>
</html>
