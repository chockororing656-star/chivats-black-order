<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î - CHIVATS BLACK</title>

<style>
  body {
    margin: 0;
    font-family: sans-serif;
    background: #111;
    color: #fff;
    padding: 16px;
  }
  h1 {
    color: #f5c16c;
    margin-bottom: 16px;
  }
  .card {
    background: #1e1e1e;
    padding: 14px;
    border-radius: 10px;
    margin-bottom: 14px;
    border-left: 4px solid #f5c16c;
  }
  ul {
    padding-left: 18px;
  }
</style>
</head>

<body>

<h1>üì¶ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Äì CHIVATS BLACK</h1>
<div id="orders">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå...</div>

<!-- üî• Firebase (‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    query,
    orderBy,
    onSnapshot
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // üî¥ ‡πÉ‡∏™‡πà CONFIG ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  const firebaseConfig = {
    apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
    authDomain: "chivats-black-order.firebaseapp.com",
    projectId: "chivats-black-order",
    storageBucket: "chivats-black-order.appspot.com",
    messagingSenderId: "1012545451252",
    appId: "1:1012545451252:web:0df1a74dc553f201bddaa1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const orderList = document.getElementById("orders");

  const q = query(
    collection(db, "orders"),
    orderBy("time", "desc")
  );

  onSnapshot(q, (snapshot) => {
    orderList.innerHTML = "";

    if (snapshot.empty) {
      orderList.innerHTML = "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå";
      return;
    }

    snapshot.forEach(doc => {
      const d = doc.data();

      const date = d.time?.toDate();
      const dateText = date
        ? date.toLocaleDateString("th-TH") + " " + date.toLocaleTimeString("th-TH")
        : "-";

      let itemsHtml = "";
      d.items.forEach(i => {
        itemsHtml += `<li>${i.name} x ${i.qty} = ${i.price * i.qty}‡∏ø</li>`;
      });

      orderList.innerHTML += `
        <div class="card">
          <p><b>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤:</b> ${dateText}</p>
          <p><b>üë§ ‡∏ä‡∏∑‡πà‡∏≠:</b> ${d.name}</p>
          <p><b>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</b> ${d.phone}</p>
          <p><b>üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</b> ${d.payment}</p>
          <ul>${itemsHtml}</ul>
          <b>üí∞ ‡∏£‡∏ß‡∏° ${d.total} ‡∏ö‡∏≤‡∏ó</b>
        </div>
      `;
    });
  });
</script>

</body>
</html>
