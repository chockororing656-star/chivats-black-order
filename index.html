<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHIVATS BLACK ORDER</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:sans-serif;background:#111;color:#fff}
.container{max-width:480px;margin:auto;padding:20px}
h1{color:#f5c16c;text-align:center}
.menu-item{display:flex;justify-content:space-between;align-items:center;
background:#1b1b1b;padding:12px;margin-bottom:10px;border-radius:8px}
.qty button{width:32px;height:32px;font-size:18px}
.total{font-size:18px;color:#6aff6a;margin:15px 0}
input{width:100%;padding:12px;margin-bottom:10px}
.payment{display:flex;gap:20px;margin:10px 0}
button{width:100%;padding:15px;font-size:18px;background:#f5c16c;border:none}
</style>
</head>

<body>
<div class="container">
<h1>ü•ô CHIVATS BLACK</h1>

<div id="menu"></div>

<div class="total">üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="total">0</span> ‡∏ö‡∏≤‡∏ó</div>

<input id="customerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á">
<input id="customerPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">

<div class="payment">
  <label><input type="radio" name="pay" value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î" checked> ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</label>
  <label><input type="radio" name="pay" value="PromptPay"> PromptPay</label>
</div>

<button onclick="submitOrder()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
</div>

<script>
/* ===== Firebase ===== */
firebase.initializeApp({
  apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
  authDomain: "chivats-black-order.firebaseapp.com",
  projectId: "chivats-black-order"
});
const db = firebase.firestore();

/* ===== ‡πÄ‡∏°‡∏ô‡∏π ===== */
const menuData = [
 {name:"‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà ‡πÑ‡∏ã‡∏ï‡πå L",price:69},
 {name:"‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà ‡πÑ‡∏ã‡∏ï‡πå M",price:60},
 {name:"‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L",price:45},
 {name:"‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M",price:40},
 {name:"‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L",price:45},
 {name:"‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M",price:40},
 {name:"‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢ + ‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ",price:45}
];

let cart = Array(menuData.length).fill(0);
const menuEl = document.getElementById("menu");

menuData.forEach((m,i)=>{
  menuEl.innerHTML += `
    <div class="menu-item">
      <div>${m.name}<br>${m.price} ‡∏ø</div>
      <div class="qty">
        <button onclick="chg(${i},-1)">-</button>
        <span id="q${i}">0</span>
        <button onclick="chg(${i},1)">+</button>
      </div>
    </div>`;
});

function chg(i,d){
  cart[i]=Math.max(0,cart[i]+d);
  document.getElementById("q"+i).innerText=cart[i];
  calc();
}
function calc(){
  let t=0;
  menuData.forEach((m,i)=>t+=m.price*cart[i]);
  document.getElementById("total").innerText=t;
}

function submitOrder(){
  const name=customerName.value.trim();
  const phone=customerPhone.value.trim();
  const payment=document.querySelector("input[name=pay]:checked").value;
  if(!name||!phone) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");

  const items=[];
  menuData.forEach((m,i)=>{
    if(cart[i]>0) items.push({...m,qty:cart[i]});
  });
  if(items.length===0) return alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π");

  db.collection("orders").add({
    name, phone, payment,
    items,
    total:+total.innerText,
    branch:"‡∏™‡∏≤‡∏Ç‡∏≤‡∏´‡∏•‡∏±‡∏Å",
    time:firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    alert("‚úÖ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß");
    location.reload();
  });
}
</script>
</body>
</html>
