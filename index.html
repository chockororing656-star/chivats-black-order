<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>CHIVATS BLACK - ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      padding: 16px;
    }
    h1 {
      color: #f5a623;
      text-align: center;
    }
    .item {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      border-bottom: 1px solid #333;
      padding-bottom: 6px;
    }
    button {
      padding: 4px 10px;
      margin: 0 2px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
    }
    .total {
      font-size: 20px;
      margin: 12px 0;
      text-align: center;
    }
  </style>
</head>

<body>

<h1>CHIVATS BLACK</h1>

<div id="menu"></div>

<div class="total">
  ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="total">0</span> ‡∏ö‡∏≤‡∏ó
</div>

<h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
<input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
<input id="phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">

<h3>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
<select id="payment">
  <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
  <option value="promptpay">PromptPay</option>
</select>

<input id="slip" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏•‡∏¥‡∏õ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">

<button onclick="submitOrder()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // üî¥ ‡πÉ‡∏™‡πà Firebase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  const firebaseConfig = {
    apiKey: "‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
    authDomain: "‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
    projectId: "‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const menu = [
    ["‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà L", 69],
    ["‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà M", 60],
    ["‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L", 45],
    ["‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M", 40],
    ["‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L", 45],
    ["‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M", 40],
    ["‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢ + ‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ", 45]
  ];

  let cart = {};
  const menuDiv = document.getElementById("menu");
  const totalSpan = document.getElementById("total");

  menu.forEach((m, i) => {
    cart[i] = 0;
    const d = document.createElement("div");
    d.className = "item";
    d.innerHTML = `
      ${m[0]} (${m[1]}‡∏ø)
      <span>
        <button onclick="cart[${i}]--; update()">-</button>
        <span id="q${i}">0</span>
        <button onclick="cart[${i}]++; update()">+</button>
      </span>
    `;
    menuDiv.appendChild(d);
  });

  window.update = function () {
    let t = 0;
    menu.forEach((m, i) => {
      if (cart[i] < 0) cart[i] = 0;
      document.getElementById("q" + i).innerText = cart[i];
      t += cart[i] * m[1];
    });
    totalSpan.innerText = t;
  }

  window.submitOrder = async function () {
    if (!name.value || !phone.value) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£");
      return;
    }

    await addDoc(collection(db, "orders"), {
      name: name.value,
      phone: phone.value,
      payment: payment.value,
      slip: slip.value,
      cart: cart,
      total: Number(totalSpan.innerText),
      createdAt: serverTimestamp()
    });

    alert("‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß üôè");
    location.reload();
  }
</script>

</body>
</html>