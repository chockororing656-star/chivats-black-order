<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHIVATS BLACK ORDER</title>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#111;
  color:#fff;
}
.container{
  max-width:480px;
  margin:auto;
  padding:16px;
}
h1{
  text-align:center;
  color:#f5c04f;
}
.menu button{
  width:100%;
  margin:6px 0;
  padding:14px;
  border:none;
  border-radius:10px;
  background:#f5c04f;
  font-size:16px;
}
.card{
  background:#1c1c1c;
  border-radius:10px;
  padding:12px;
  margin-top:12px;
}
input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  font-size:16px;
}
.total{
  font-size:18px;
  margin-top:8px;
}
.payment label{
  display:block;
  margin:6px 0;
}
button#submitOrder{
  margin-top:14px;
  width:100%;
  padding:16px;
  font-size:18px;
  background:#f5c04f;
  border:none;
  border-radius:12px;
}
</style>
</head>

<body>
<div class="container">

<h1>üç¢ CHIVATS BLACK</h1>

<!-- MENU -->
<div class="menu">
  <button onclick="addItem('‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà L',69)">‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà L +69</button>
  <button onclick="addItem('‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà M',60)">‡πÄ‡∏Ñ‡∏ö‡∏±‡∏ö‡πÑ‡∏Å‡πà M +60</button>
  <button onclick="addItem('‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L',45)">‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L +45</button>
  <button onclick="addItem('‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M',40)">‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M +40</button>
  <button onclick="addItem('‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L',45)">‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ L +45</button>
  <button onclick="addItem('‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M',40)">‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤ M +40</button>
  <button onclick="addItem('‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢ + ‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ',45)">‡πÄ‡∏ü‡∏£‡∏ô‡∏ü‡∏£‡∏≤‡∏¢ + ‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ +45</button>
</div>

<!-- CART -->
<div class="card">
  <div id="cartList">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
  <div class="total">üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="total">0</span> ‡∏ö‡∏≤‡∏ó</div>
</div>

<!-- CUSTOMER -->
<div class="card">
  <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
  <input id="customerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
  <input id="customerPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
</div>

<!-- PAYMENT -->
<div class="card payment">
  <h3>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
  <label><input type="radio" name="pay" value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î" checked> ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</label>
  <label><input type="radio" name="pay" value="PromptPay"> PromptPay</label>
</div>

<button id="submitOrder" type="button">‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* ================= FIREBASE ================= */
const firebaseConfig = {
  apiKey: "AIzaSyC03JcyEyEg4iWVKMfgcpDR82EUiFOXMd4",
  authDomain: "chivats-black-order.firebaseapp.com",
  projectId: "chivats-black-order",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ================= TELEGRAM ================= */
const TELEGRAM_BOT_TOKEN = "8529657624:AAHeinqknXFiKrgyuyOz7h-GCbPUVoHWf3Q";
const TELEGRAM_CHAT_ID  = "566507150";

/* ================= DATA ================= */
let cart = [];

function addItem(name, price){
  cart.push({name, price});
  renderCart();
}

function renderCart(){
  const list = document.getElementById("cartList");
  if(cart.length === 0){
    list.innerHTML = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£";
  }else{
    list.innerHTML = cart.map(i=>`‚Ä¢ ${i.name} ${i.price}‡∏ø`).join("<br>");
  }
  document.getElementById("total").innerText =
    cart.reduce((s,i)=>s+i.price,0);
}

document.getElementById("submitOrder").onclick = async () => {

  if(cart.length === 0){
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π");
    return;
  }

  const name = document.getElementById("customerName").value || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠";
  const phone = document.getElementById("customerPhone").value || "-";
  const payment = document.querySelector('input[name="pay"]:checked').value;
  const total = cart.reduce((s,i)=>s+i.price,0);

  const order = {
    name,
    phone,
    payment,
    items: cart,
    total,
    status: "new",
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  };

  /* üî• ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Firebase */
  await db.collection("orders").add(order);

  /* üîî Telegram (await + ‡∏ä‡∏±‡∏ß‡∏£‡πå) */
  const message =
`üõé ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà - CHIVATS BLACK
üë§ ‡∏ä‡∏∑‡πà‡∏≠: ${name}
üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå: ${phone}
üí≥ ‡∏ä‡∏≥‡∏£‡∏∞: ${payment}
üí∞ ‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó

${cart.map(i=>`‚Ä¢ ${i.name} ${i.price}‡∏ø`).join("\n")}`;

  await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: TELEGRAM_CHAT_ID,
      text: message
    })
  });

  alert("‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
  cart = [];
  renderCart();
};
</script>

</body>
</html>

